<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Easbroidery — Editor</title>
  <!-- Keep global site styles exactly as-is -->
  <link rel="stylesheet" href="styles.css">
  <!-- Editor-only styles (scoped so nothing leaks) -->
  <link rel="stylesheet" href="editor.css">
</head>
<body class="editor-shell">
  <!-- Top Bar -->
  <header class="eb-topbar" role="banner">
    <div class="eb-topbar__left">
      <a href="index.html" class="eb-brand">
        <img src="assets/logo.png" alt="Easbroidery" class="eb-brand__logo">
        <span class="eb-brand__name">Easbroidery</span>
      </a>
    </div>
    <nav class="eb-menubar" aria-label="Editor menu">
      <button class="eb-menu__btn" data-action="file">File</button>
      <button class="eb-menu__btn" data-action="edit">Edit</button>
    </nav>
    <div class="eb-topbar__right">
      <button id="eb-save" class="eb-btn eb-btn--secondary">Save</button>
      <button id="eb-export" class="eb-btn eb-btn--primary">Export</button>
    </div>
  </header>

  <!-- Three-pane layout -->
  <main class="eb-layout" role="main">
    <!-- Left rail -->
    <aside class="eb-rail" aria-label="Tools">
      <ul class="eb-tools" role="toolbar" aria-orientation="vertical">
        <li><button class="eb-tool" data-tool="select" aria-label="Select">
          <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M6 4l12 8-12 8V4z"/></svg><span>Select</span>
        </button></li>
        <li><button class="eb-tool" data-tool="brush" aria-label="Brush">
          <svg viewBox="0 0 24 24"><path d="M20 4l-6 6 2 2 6-6-2-2zM4 20c3 0 4-2 5-3l6-6-2-2-6 6c-1 1-3 2-3 5z"/></svg><span>Brush</span>
        </button></li>
        <li><button class="eb-tool" data-tool="eraser" aria-label="Eraser">
          <svg viewBox="0 0 24 24"><path d="M16 3l5 5-9 9H7L2 12 11 3h5zM7 19h15v2H7z"/></svg><span>Eraser</span>
        </button></li>
        <li><button class="eb-tool" data-tool="wand" aria-label="Magic Wand">
          <svg viewBox="0 0 24 24"><path d="M2 20l6-6 2 2-6 6-2-2zm9-9l7-7 2 2-7 7-2-2z"/></svg><span>Wand</span>
        </button></li>
        <li><button class="eb-tool" data-tool="lasso" aria-label="Lasso">
          <svg viewBox="0 0 24 24"><path d="M12 4C7 4 4 7 4 10s3 6 8 6 8-3 8-6-3-6-8-6zm-2 13c-2 0-3 1-3 2s1 2 3 2 3-1 3-2-1-2-3-2z"/></svg><span>Lasso</span>
        </button></li>
        <li><button class="eb-tool" data-tool="text" aria-label="Text">
          <svg viewBox="0 0 24 24"><path d="M4 6V4h16v2h-7v14h-2V6H4z"/></svg><span>Text</span>
        </button></li>
        <li><button class="eb-tool" data-tool="shapes" aria-label="Shapes">
          <svg viewBox="0 0 24 24"><path d="M3 3h8v8H3zM13 13l4-4 4 4-4 4-4-4zM13 3h8v8h-8z"/></svg><span>Shapes</span>
        </button></li>
        <li><button class="eb-tool" data-tool="uploads" aria-label="Uploads">
          <svg viewBox="0 0 24 24"><path d="M12 3l4 4h-3v6h-2V7H8l4-4zM4 17h16v4H4z"/></svg><span>Uploads</span>
        </button></li>
        <li><button class="eb-tool" data-tool="layers" aria-label="Layers">
          <svg viewBox="0 0 24 24"><path d="M12 4l8 4-8 4-8-4 8-4zm0 6l8 4-8 4-8-4 8-4z"/></svg><span>Layers</span>
        </button></li>
      </ul>

      <!-- Mini hoop -->
      <section class="eb-loom" aria-label="Loom preview">
        <h2 class="eb-loom__title">Loom preview</h2>
        <div class="eb-loom__card">
          <canvas id="loomPreviewCanvas" width="160" height="160" aria-label="Mini hoop live preview"></canvas>
        </div>
        <button id="loomPreviewEnlarge" class="eb-btn eb-btn--ghost">Enlarge</button>
      </section>

      <!-- Phone: preview → button -->
      <button id="previewFab" class="eb-fab" aria-label="Open Loom preview">Preview</button>
    </aside>

    <!-- Stage -->
    <section class="eb-stage" aria-label="Editor canvas">
      <div class="eb-canvas-wrap">
        <div class="eb-ruler eb-ruler--top"></div>
        <div class="eb-ruler eb-ruler--left"></div>
        <canvas id="mainCanvas" width="1600" height="1200" aria-label="Edit canvas"></canvas>
      </div>
    </section>

    <!-- Right context -->
    <aside class="eb-context" aria-label="Tool settings">
      <h3>Contextual settings for active tool</h3>
      <div id="contextMount"></div>
    </aside>
  </main>

  <!-- Bottom status -->
  <footer class="eb-status" role="contentinfo">
    <div class="eb-status__group">
      <span id="statusZoom">Zoom 100%</span>
      <span id="statusHoop">4.0" × 4.0</span>
      <span id="statusStitches">0 stitches</span>
    </div>
    <button id="btnConvert" class="eb-btn eb-btn--primary">Convert</button>
  </footer>

  <!-- Enlarge modal -->
  <dialog id="previewModal" class="eb-modal" aria-label="Loom preview">
    <div class="eb-modal__head">
      <h4>Loom preview</h4>
      <button id="previewModalClose" class="eb-iconbtn" aria-label="Close">✕</button>
    </div>
    <div class="eb-modal__body">
      <canvas id="loomPreviewLarge" width="900" height="700" aria-label="Large hoop preview"></canvas>
    </div>
  </dialog>

  <!-- Existing runtime -->
  <script src="lib/ort.min.js"></script>
  <script src="app.js"></script>
  <script src="script.upload.js"></script>
  <script src="script.preview.js"></script>
  <script src="script.draw.js"></script>
  <script src="processing.js"></script>
  <script src="worker.js"></script>

  <!-- Editor-only glue -->
  <script src="editor.ui.js"></script>
</body>
</html>