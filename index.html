<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
  <title>Loomabelle â€” Image â†’ Embroidery</title>

  <!-- Brand fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Merienda:wght@700&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="css/style.css"/>
</head>
<body>
  <header class="topbar" role="banner">
    <img src="assets/logo.png" class="logo" alt="Loomabelle logo" />
    <div class="brand">
      <h1 class="stitched-title">Loomabelle</h1>
      <p class="subtitle">Turn art into embroidery files â€” fast and phoneâ€‘friendly.</p>
    </div>
  </header>

  <main class="wrap" role="main">
    <section class="panel controls">

      <!-- Tabs -->
      <nav class="tabs" aria-label="Input mode">
        <button class="tab active" data-tab="upload" aria-selected="true">Upload</button>
        <button class="tab" data-tab="draw" aria-selected="false">Draw</button>
      </nav>

      <!-- Upload tab -->
      <div class="tab-body active" id="tab-upload">
        <label class="dropzone" id="dz">
          <input type="file" id="fileInput" accept="image/png,image/jpeg,image/heic,image/heif" />
          <div class="dz-visual">
            <div class="dz-icon">ðŸ§µ</div>
            <div class="dz-text"><b>Drop image</b> or tap to choose <small>(JPG/PNG/HEIC)</small></div>
          </div>
        </label>
      </div>

      <!-- Draw tab (lazy built; nothing visible until selected) -->
      <div class="tab-body" id="tab-draw" aria-hidden="true"></div>

      <!-- Minimal surface. Options are hidden until requested. -->
      <label class="toggle big">
        <input id="toggleOptions" type="checkbox">
        <span class="pill">âœ‚ï¸Ž Edit options</span>
      </label>

      <div id="optionsPanel" class="options hidden" aria-hidden="true">
        <div class="grid">
          <label>Machine preset
            <select id="preset">
              <option value="generic">Generic / Other</option>
              <option value="brother-se2000" selected>Brother SE2000 (5Ã—7)</option>
            </select>
          </label>

          <label>Hoop
            <select id="hoop">
              <option value="100x100">4Ã—4 (100Ã—100mm)</option>
              <option value="130x180" selected>5Ã—7 (130Ã—180mm)</option>
              <option value="160x260">6Ã—10 (160Ã—260mm)</option>
              <option value="custom">Customâ€¦</option>
            </select>
          </label>

          <div id="customHoopFields" class="row hidden">
            <label>W (mm) <input id="hoopW" type="number" min="40" max="400" value="130"></label>
            <label>H (mm) <input id="hoopH" type="number" min="40" max="400" value="180"></label>
          </div>

          <label data-when="autoColors:on">Max colors (2â€“6)
            <input id="maxColors" type="number" min="2" max="6" value="4">
          </label>

          <div id="manualPalette" class="manual hidden" data-when="autoColors:off">
            <div class="row">
              <label>Color 1 <input type="color" value="#000000" /></label>
              <label>Color 2 <input type="color" value="#ffffff" /></label>
              <label>Color 3 <input type="color" value="#74a9bd" /></label>
              <label>Color 4 <input type="color" value="#d8a238" /></label>
              <label class="optional">Color 5 <input type="color" value="#c76033" /></label>
              <label class="optional">Color 6 <input type="color" value="#7f7f7f" /></label>
            </div>
            <small>Tip: pick up to 6 brand/thread-like colors. Unused colors are ignored.</small>
          </div>

          <label>Fill angleÂ°
            <input id="fillAngle" type="number" min="0" max="180" value="45">
          </label>

          <label>Density (mm)
            <input id="density" type="number" step="0.05" min="0.25" max="1.5" value="0.40">
          </label>

          <div class="row" data-when="removeBg:on">
            <label>Background removal
              <input id="removeBg" type="checkbox" checked>
            </label>
            <label>Strength
              <input id="bgStrength" type="range" min="0" max="100" value="30">
            </label>
          </div>

          <label>Outline (satin-ish)
            <input id="outline" type="checkbox" checked>
          </label>

          <label>Auto colors
            <input id="autoColors" type="checkbox" checked>
          </label>
        </div>
      </div>

      <div class="actions">
        <button id="btnProcess" class="btn primary" disabled>Process</button>
        <button id="btnDownloadDST" class="btn" disabled>Download .DST</button>
        <button id="btnDownloadPalette" class="btn" disabled>Palette (.txt)</button>
        <button id="btnBrotherTips" class="btn ghost">Brother tips</button>
      </div>

      <details class="notes">
        <summary>Helpful notes</summary>
        <ul>
          <li>Upload a logo-style image (3â€“6 colors) for best results.</li>
          <li>We add thread-change stops between color blocks.</li>
          <li>Use Custom hoop if your frame differs.</li>
        </ul>
      </details>

      <div class="log" id="log" role="log" aria-live="polite"></div>
    </section>

    <section class="panel preview">
      <h2 class="stitched">Preview (with hoop)</h2>
      <div class="hoop">
        <canvas id="preview" width="640" height="640" aria-label="Embroidery preview"></canvas>
        <p class="hint">Rounded rectangle = hoop bounds.</p>
      </div>
    </section>
  </main>

  <footer class="foot">
    <small>Made with â™¥ â€” runs 100% in your browser.</small>
  </footer>

  <dialog id="brotherDialog">
    <h3>Brother SE2000 tips</h3>
    <ol>
      <li>Select <b>5Ã—7 (130Ã—180mm)</b> hoop.</li>
      <li>Tap <b>Process</b> â†’ <b>Download .DST</b>. Put on USB (or use Brother app).</li>
      <li>The machine will pause for color changes. Assign threads on-screen.</li>
    </ol>
    <form method="dialog"><button class="btn primary">Got it</button></form>
  </dialog>

  <script type="module" src="js/app.js"></script>
</body>
</html>